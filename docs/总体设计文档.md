# 总体设计文档
## 项目名称/文档作者
- 项目名称：bookstore-2025
- 文档作者：付长睿
## 程序功能概述：
- 账户管理：支持账户注册、登录（嵌套登录）、注销、密码修改、账户创建/删除、按权限分级管控等操作。
- 图书管理：支持图书检索、购买、选中、信息修改、进货、维护图书ISBN、图书名称、作者、关键词、库存、价格等图书的核心信息。
- 日志管理：记录财务交易、员工操作日志、支持财务报表、员工工作报表生成及日志查询。
- 文件外存：基于块状链表实现从外存轻量读取数据，避免全量内存存储，满足大规模数据访问需求。
## 主题逻辑说明：
系统启动之后首先完成初始化（创建root超级管理账户） 随后进入指令循环；
- 1.读取命令行的输入指令，进行语法解析和合法性校验（字符类型是否合法、字符串长度是否合法等等）
- 2.校验当前登录账户的权限等级，判断用户是否能够执行该命令。
- 3.调用对应模块（账户系统、图书系统）的函数处理指令（如账户登录、图书购买等）。
- 4.从外存文件读取数据，返回操作结果。
- 5.直至读取到quit/exit指令或EOF，系统停止工作并进行数据清理。
## 功能设计
| 模块名称 | 核心功能                         | 输入 | 输出 |
|------|------------------------------|----|----|
|  指令解析模块    | 解析命令行输入，校验指令格式、并将信息解析分类到各个模块 |  字符串型指令  |  指令类型 + 参数列表 / 非法指令标识  |
|   权限管理模块   |           维护登录栈，校验当前账户权限，判断指令执行权限                   |  登录账户 ID / 指令权限要求  |  权限校验结果（通过 / 拒绝）  |
|   账户管理模块   |              账户注册 / 登录 / 注销 / 密码修改 / 创建 / 删除，维护账户信息                |  账户相关参数（ID / 密码 / 权限等）  |  操作结果（成功 / 失败）  |
|   图书管理模块   |                  图书检索 / 购买 / 选中 / 修改 / 进货，维护图书库存与信息            |  图书相关参数（ISBN / 数量等）  |  操作结果 + 图书数据 / 金额等  |
|   日志管理模块   |                    记录财务交易、员工操作，生成报表，查询日志          | 日志查询参数（条数 / 类型）   |   日志数据 / 报表内容 |
## 数据库设计
- 账户系统数据设计

| 数据项          | 类型     | 说明                             |
|--------------|--------|--------------------------------|
| USERID       | string | 账户ID，合法字符：数字 / 字母 / 下划线，最大长度30 |
| Password     | string |                 密码，合法字符：数字 / 字母 / 下划线，最大长度 30               |
| Username     | string |                  用户名，合法字符：可见 ASCII，最大长度 30              |
| Privilege    | int    |                 权限等级（0/1/3/7），默认注册账户为 1               |
| is_logged_in | bool   |                是否处于登录状态                |
- 图书系统数据设计

| 数据项      | 类型     | 说明 |
|----------|--------|----|
| ISBN     | string |  图书 ISBN，主键，合法字符：可见 ASCII，最大长度 20，唯一 |
| Bookname | string | 书名，合法字符：可见 ASCII（不含双引号），最大长度 60   |
| Author   | string |  作者，合法字符：可见 ASCII（不含双引号），最大长度 60  |
| Keyword  | string |  关键词，，合法字符：可见 ASCII（不含双引号），最大长度 60  |
| Price    | double |  单价，精度保留两位小数，非负  |
| Stock    | int    |  库存数量，非负  |


